<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- wizard view -->
    <record id="create_revision_wizard_view" model="ir.ui.view">
        <field name="name">description.create.revision.wizard</field>
        <field name="model">create.revision.wizard</field>
        <field name="arch" type="xml">
            <form string="Description Of Change">
                <group>
                    <field name="description_of_change"/>
                    <field name="po_id" invisible="1"/>
                </group>
                <field name="po_lines"
                    widget="section_and_note_one2many"
                    mode="tree,kanban"
                    context="{'default_state': 'draft', 'default_order_id':po_id}">
                    <tree string="Purchase Order Lines" editable="bottom">
                        <control>
                            <create name="add_product_control" string="Add a product"/>
                            <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                            <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                        </control>
                        <field name="display_type" invisible="1"/>
                         <field
                            name="product_id"
                            attrs="{
                                'required': [('display_type', '=', False)],
                            }"
                            context="{ 'quantity':product_qty,'uom':product_uom}"
                            force_save="1" domain="[('purchase_ok', '=', True)]"/>
                        <field name="name" widget="section_and_note_text"/>
                        <field name="product_qty"/>
                        <field name="price_unit" attrs="{'readonly': [('qty_invoiced', '!=', 0)]}"/>
                        <field name="price_subtotal" widget="monetary"/>
                        <!-- <field name="order_id" invisible="0"/> -->
                        <field name="state" invisible="1"/>
                        <field name="is_changed" invisible="1"/>
                        <field name="product_uom" invisible="1"/>
                        <field name="qty_invoiced" invisible="1"/>
                        <field name="product_uom_category_id" invisible="1"/>
                        <field name="company_id" invisible="1"/>
                        <field name="order_id" invisible="1"/>
                    </tree>
                </field>
                <footer>
                    <button string="Update" class="btn-primary" type="object"
                            name="update_purchase_order"/>
                    <button string="Cancel" class="btn-secondary"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <record model="ir.actions.act_window" id="action_create_revision_wizard">
        <field name="name">Create Revision Action Wizard</field>
        <field name="res_model">create.revision.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{"from_wizard_po_revision":True}</field>
        <field name="binding_model_id" ref="model_purchase_order"/>
    </record>
</odoo>